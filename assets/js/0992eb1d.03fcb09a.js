"use strict";(self.webpackChunkexpenses_docs=self.webpackChunkexpenses_docs||[]).push([[5253],{8453:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>i});var c=n(6540);const r={},t=c.createContext(r);function d(e){const s=c.useContext(t);return c.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),c.createElement(t.Provider,{value:s},e.children)}},9378:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>d,metadata:()=>c,toc:()=>l});const c=JSON.parse('{"id":"LLD/accounts-ms/Database","title":"Database","description":"I\'ll propose an ER diagram structure for the Accounts Microservice based on your requirements.","source":"@site/docs/LLD/accounts-ms/Database.md","sourceDirName":"LLD/accounts-ms","slug":"/LLD/accounts-ms/Database","permalink":"/expenses-docs/docs/LLD/accounts-ms/Database","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/LLD/accounts-ms/Database.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ErrorResponse","permalink":"/expenses-docs/docs/LLD/ErrorResponse"},"next":{"title":"Project Setup","permalink":"/expenses-docs/docs/setup"}}');var r=n(4848),t=n(8453);const d={},i=void 0,o={},l=[{value:"<strong>Proposed Tables for <code>Accounts Microservice</code></strong>",id:"proposed-tables-for-accounts-microservice",level:3},{value:"<strong>1. <code>accounts</code> (Stores different types of accounts)</strong>",id:"1-accounts-stores-different-types-of-accounts",level:4},{value:"<strong>2. <code>account_details</code> (Stores extra attributes per account type)</strong>",id:"2-account_details-stores-extra-attributes-per-account-type",level:4},{value:"<strong>3. <code>user_accounts</code> (Many-to-Many mapping between users and accounts)</strong>",id:"3-user_accounts-many-to-many-mapping-between-users-and-accounts",level:4},{value:"<strong>How External Data is Fetched</strong>",id:"how-external-data-is-fetched",level:3},{value:"<strong>Microservice Design Options for User-Account Mapping</strong>",id:"microservice-design-options-for-user-account-mapping",level:3}];function a(e){const s={code:"code",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["I'll propose an ",(0,r.jsx)(s.strong,{children:"ER diagram"})," structure for the ",(0,r.jsx)(s.code,{children:"Accounts Microservice"})," based on your requirements."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"proposed-tables-for-accounts-microservice",children:(0,r.jsxs)(s.strong,{children:["Proposed Tables for ",(0,r.jsx)(s.code,{children:"Accounts Microservice"})]})}),"\n",(0,r.jsx)(s.h4,{id:"1-accounts-stores-different-types-of-accounts",children:(0,r.jsxs)(s.strong,{children:["1. ",(0,r.jsx)(s.code,{children:"accounts"})," (Stores different types of accounts)"]})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Column Name"}),(0,r.jsx)(s.th,{children:"Data Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"account_id"})}),(0,r.jsx)(s.td,{children:"UUID (PK)"}),(0,r.jsx)(s.td,{children:"Unique identifier for each account"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"user_id"})}),(0,r.jsx)(s.td,{children:"UUID (FK)"}),(0,r.jsx)(s.td,{children:"References the user who owns the account"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"account_type"})}),(0,r.jsx)(s.td,{children:"ENUM"}),(0,r.jsxs)(s.td,{children:["Type of account (",(0,r.jsx)(s.code,{children:"SAVINGS"}),", ",(0,r.jsx)(s.code,{children:"CREDIT_CARD"}),", ",(0,r.jsx)(s.code,{children:"LOAN"}),", ",(0,r.jsx)(s.code,{children:"INVESTMENT"}),", etc.)"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"account_number"})}),(0,r.jsx)(s.td,{children:"STRING"}),(0,r.jsx)(s.td,{children:"Unique account number from an external provider"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"institution_name"})}),(0,r.jsx)(s.td,{children:"STRING"}),(0,r.jsx)(s.td,{children:"Name of the bank, credit card provider, etc."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"balance"})}),(0,r.jsx)(s.td,{children:"DECIMAL"}),(0,r.jsx)(s.td,{children:"Current balance (only for tracking, not real transactions)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"currency"})}),(0,r.jsx)(s.td,{children:"STRING"}),(0,r.jsxs)(s.td,{children:["Currency type (",(0,r.jsx)(s.code,{children:"USD"}),", ",(0,r.jsx)(s.code,{children:"INR"}),", etc.)"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"created_at"})}),(0,r.jsx)(s.td,{children:"TIMESTAMP"}),(0,r.jsx)(s.td,{children:"When the account was added to the system"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"updated_at"})}),(0,r.jsx)(s.td,{children:"TIMESTAMP"}),(0,r.jsx)(s.td,{children:"Last modification time"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h4,{id:"2-account_details-stores-extra-attributes-per-account-type",children:(0,r.jsxs)(s.strong,{children:["2. ",(0,r.jsx)(s.code,{children:"account_details"})," (Stores extra attributes per account type)"]})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Column Name"}),(0,r.jsx)(s.th,{children:"Data Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"account_detail_id"})}),(0,r.jsx)(s.td,{children:"UUID (PK)"}),(0,r.jsx)(s.td,{children:"Unique identifier for account details"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"account_id"})}),(0,r.jsx)(s.td,{children:"UUID (FK)"}),(0,r.jsxs)(s.td,{children:["References ",(0,r.jsx)(s.code,{children:"accounts.account_id"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"interest_rate"})}),(0,r.jsx)(s.td,{children:"DECIMAL"}),(0,r.jsx)(s.td,{children:"Interest rate for savings, loan, or investment accounts"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"credit_limit"})}),(0,r.jsx)(s.td,{children:"DECIMAL"}),(0,r.jsx)(s.td,{children:"Only for credit card accounts"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"loan_amount"})}),(0,r.jsx)(s.td,{children:"DECIMAL"}),(0,r.jsx)(s.td,{children:"Total loan amount (only for loan accounts)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"maturity_date"})}),(0,r.jsx)(s.td,{children:"TIMESTAMP"}),(0,r.jsx)(s.td,{children:"Only for loan and investment accounts"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"investment_type"})}),(0,r.jsx)(s.td,{children:"STRING"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"STOCKS"}),", ",(0,r.jsx)(s.code,{children:"BONDS"}),", ",(0,r.jsx)(s.code,{children:"MUTUAL_FUNDS"}),", etc. (for investment accounts)"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"created_at"})}),(0,r.jsx)(s.td,{children:"TIMESTAMP"}),(0,r.jsx)(s.td,{children:"Record creation time"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"updated_at"})}),(0,r.jsx)(s.td,{children:"TIMESTAMP"}),(0,r.jsx)(s.td,{children:"Last modification time"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h4,{id:"3-user_accounts-many-to-many-mapping-between-users-and-accounts",children:(0,r.jsxs)(s.strong,{children:["3. ",(0,r.jsx)(s.code,{children:"user_accounts"})," (Many-to-Many mapping between users and accounts)"]})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Column Name"}),(0,r.jsx)(s.th,{children:"Data Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"user_account_id"})}),(0,r.jsx)(s.td,{children:"UUID (PK)"}),(0,r.jsx)(s.td,{children:"Unique ID for the mapping"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"user_id"})}),(0,r.jsx)(s.td,{children:"UUID (FK)"}),(0,r.jsxs)(s.td,{children:["References the ",(0,r.jsx)(s.code,{children:"User Microservice"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"account_id"})}),(0,r.jsx)(s.td,{children:"UUID (FK)"}),(0,r.jsxs)(s.td,{children:["References ",(0,r.jsx)(s.code,{children:"accounts.account_id"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"role"})}),(0,r.jsx)(s.td,{children:"ENUM"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"OWNER"}),", ",(0,r.jsx)(s.code,{children:"CO_OWNER"}),", ",(0,r.jsx)(s.code,{children:"AUTHORIZED_USER"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"created_at"})}),(0,r.jsx)(s.td,{children:"TIMESTAMP"}),(0,r.jsx)(s.td,{children:"When the mapping was created"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"how-external-data-is-fetched",children:(0,r.jsx)(s.strong,{children:"How External Data is Fetched"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Transaction details"})," \u2192 Retrieved from ",(0,r.jsx)(s.strong,{children:"Expense Service"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Payment history"})," \u2192 Retrieved from ",(0,r.jsx)(s.strong,{children:"External API or Payment Service"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"User details"})," \u2192 Retrieved from ",(0,r.jsx)(s.strong,{children:"User Microservice"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"microservice-design-options-for-user-account-mapping",children:(0,r.jsx)(s.strong,{children:"Microservice Design Options for User-Account Mapping"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.strong,{children:["Store ",(0,r.jsx)(s.code,{children:"user_accounts"})," table inside ",(0,r.jsx)(s.code,{children:"Accounts Microservice"})]})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Easier to manage accounts-related queries."}),"\n",(0,r.jsx)(s.li,{children:"User Microservice stays independent."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.strong,{children:["Keep mapping in ",(0,r.jsx)(s.code,{children:"User Microservice"})]})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Accounts Microservice focuses purely on accounts."}),"\n",(0,r.jsx)(s.li,{children:"Users control their linked accounts."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.strong,{children:["Create a Separate ",(0,r.jsx)(s.code,{children:"User-Account Mapping Microservice"})]})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Best for scalability and separation of concerns."}),"\n",(0,r.jsx)(s.li,{children:"Centralized handling of multi-user access control."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["\ud83d\udd39 ",(0,r.jsx)(s.strong,{children:"Suggested Approach"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["If the mapping logic is simple (1 user = multiple accounts), keep it in ",(0,r.jsx)(s.strong,{children:"Accounts Microservice"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["If you need ",(0,r.jsx)(s.strong,{children:"advanced access control"}),", create a ",(0,r.jsx)(s.strong,{children:"User-Account Mapping Microservice"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:["Would you like a ",(0,r.jsx)(s.strong,{children:"database schema script"})," or an ",(0,r.jsx)(s.strong,{children:"ER diagram image"})," for this?"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);