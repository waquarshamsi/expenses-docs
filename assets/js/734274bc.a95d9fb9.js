"use strict";(self.webpackChunkexpenses_docs=self.webpackChunkexpenses_docs||[]).push([[1587],{1486:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>x,frontMatter:()=>d,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"HLD/Microservices/Expenses MS PRD","title":"Expenses MS PRD","description":"Here\u2019s how the Expenses Microservice can be implemented with all the requirements you mentioned:","source":"@site/docs/HLD/Microservices/Expenses MS PRD.md","sourceDirName":"HLD/Microservices","slug":"/HLD/Microservices/Expenses MS PRD","permalink":"/expenses-docs/docs/HLD/Microservices/Expenses MS PRD","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/HLD/Microservices/Expenses MS PRD.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Budgets MS PRD","permalink":"/expenses-docs/docs/HLD/Microservices/Budgets MS PRD"},"next":{"title":"Microservice Domains","permalink":"/expenses-docs/docs/HLD/Microservices/Microservice Domains"}}');var r=n(4848),t=n(8453);const d={},c=void 0,l={},h=[{value:"<strong>1\ufe0f\u20e3 Architecture &amp; Design Decisions</strong>",id:"1\ufe0f\u20e3-architecture--design-decisions",level:2},{value:"<strong>2\ufe0f\u20e3 API Endpoints (Expenses Controller)</strong>",id:"2\ufe0f\u20e3-api-endpoints-expenses-controller",level:2},{value:"<strong>3\ufe0f\u20e3 Event-Driven Communication</strong>",id:"3\ufe0f\u20e3-event-driven-communication",level:2},{value:"<strong>4\ufe0f\u20e3 Microservice Interactions</strong>",id:"4\ufe0f\u20e3-microservice-interactions",level:2},{value:"<strong>5\ufe0f\u20e3 DevOps &amp; Infra</strong>",id:"5\ufe0f\u20e3-devops--infra",level:2},{value:"<strong>6\ufe0f\u20e3 Testing &amp; Quality</strong>",id:"6\ufe0f\u20e3-testing--quality",level:2},{value:"\u2705 Expense Microservice Specification (Reactive, WebFlux)",id:"-expense-microservice-specification-reactive-webflux",level:2},{value:"\ud83d\ude80 Overview",id:"-overview",level:3},{value:"\ud83d\udce6 Tech Stack",id:"-tech-stack",level:3},{value:"\ud83d\udd17 Endpoints &amp; API Design (Reactive REST)",id:"-endpoints--api-design-reactive-rest",level:3},{value:"\ud83d\udcdc Event Topics (Kafka)",id:"-event-topics-kafka",level:3},{value:"\ud83e\udde0 Business Logic Summary",id:"-business-logic-summary",level:3},{value:"\ud83d\uddc3\ufe0f Database Schema (PostgreSQL)",id:"\ufe0f-database-schema-postgresql",level:3},{value:"Table: <code>expenses</code>",id:"table-expenses",level:4},{value:"\ud83e\udde9 Microservice Design Patterns Used",id:"-microservice-design-patterns-used",level:3},{value:"\ud83e\uddf1 OOP/Design Patterns Used",id:"-oopdesign-patterns-used",level:3},{value:"\ud83e\uddea Testing &amp; Quality",id:"-testing--quality",level:3},{value:"\ud83d\udd10 Security",id:"-security",level:3},{value:"\ud83d\udd0d Observability &amp; Monitoring",id:"-observability--monitoring",level:3},{value:"\ud83d\udea2 DevOps &amp; Infra",id:"-devops--infra",level:3},{value:"\ud83e\uddf1 Redis Usage",id:"-redis-usage",level:3},{value:"\ud83e\uddfe Future Features",id:"-future-features",level:3}];function o(e){const s={code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["Here\u2019s how the ",(0,r.jsx)(s.strong,{children:"Expenses Microservice"})," can be implemented with all the requirements you mentioned:"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"1\ufe0f\u20e3-architecture--design-decisions",children:(0,r.jsx)(s.strong,{children:"1\ufe0f\u20e3 Architecture & Design Decisions"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Saga Pattern:"})," Since the expense service interacts with accounts and inventory, the ",(0,r.jsx)(s.strong,{children:"choreography pattern"})," is preferable to avoid a central orchestrator bottleneck."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Event-Driven Approach:"})," Kafka will be used for communication with Inventory Microservice."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Resilience & Fault Tolerance:"})," Circuit breakers via ",(0,r.jsx)(s.strong,{children:"Resilience4j"})," for dependent API calls."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Security:"})," JWT/OAuth authentication with HTTPS."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Database:"})," PostgreSQL as the primary datastore."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Caching:"})," Redis for storing frequently accessed expense metadata."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Configuration Management:"})," Externalized with ",(0,r.jsx)(s.strong,{children:"Spring Cloud Config/Consul"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Secrets Management:"})," Vault for handling sensitive credentials."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Observability:"})," ",(0,r.jsx)(s.strong,{children:"Grafana, Prometheus, Loki"})," for monitoring and logs."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"APM:"})," OpenTelemetry or Jaeger for tracing requests."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"2\ufe0f\u20e3-api-endpoints-expenses-controller",children:(0,r.jsx)(s.strong,{children:"2\ufe0f\u20e3 API Endpoints (Expenses Controller)"})}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Method"}),(0,r.jsx)(s.th,{children:"Endpoint"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"POST"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses"})}),(0,r.jsx)(s.td,{children:"Create an expense (validates account & triggers inventory update if required)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"GET"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/{expenseId}"})}),(0,r.jsx)(s.td,{children:"Get expense details by ID"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"GET"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/account/{accountId}"})}),(0,r.jsx)(s.td,{children:"Get all expenses for a given account (with filtering)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"PUT"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/{expenseId}"})}),(0,r.jsx)(s.td,{children:"Update an expense (if applicable)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"DELETE"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/{expenseId}"})}),(0,r.jsx)(s.td,{children:"Soft delete an expense"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"3\ufe0f\u20e3-event-driven-communication",children:(0,r.jsx)(s.strong,{children:"3\ufe0f\u20e3 Event-Driven Communication"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Kafka Topics:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"EXPENSE_CREATED"}),": Sent when an expense is created, Inventory MS listens to check for product additions."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"EXPENSE_FAILED"}),": Sent if the expense validation fails (e.g., invalid account, insufficient funds)."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"EXPENSE_COMPLETED"}),": Sent when an expense is successfully recorded."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"4\ufe0f\u20e3-microservice-interactions",children:(0,r.jsx)(s.strong,{children:"4\ufe0f\u20e3 Microservice Interactions"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Account Validation (Pre-Expense Creation)"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Calls ",(0,r.jsx)(s.code,{children:"GET /accounts/{accountNumber}"})," of Accounts MS."]}),"\n",(0,r.jsxs)(s.li,{children:["Validates that the account is ",(0,r.jsx)(s.strong,{children:"active"})," (not closed)."]}),"\n",(0,r.jsxs)(s.li,{children:["If it's a ",(0,r.jsx)(s.strong,{children:"transfer"}),", ensures the source and destination accounts exist."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Inventory Update (If Purchase Expense)"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Calls ",(0,r.jsx)(s.code,{children:"POST /inventory"})," in Inventory MS with product details."]}),"\n",(0,r.jsxs)(s.li,{children:["If Inventory MS is down, uses a ",(0,r.jsx)(s.strong,{children:"Kafka retry mechanism"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Metadata API Call"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Calls ",(0,r.jsx)(s.code,{children:"GET /metadata/tags?category=expense"})," to fetch applicable transaction tags."]}),"\n",(0,r.jsxs)(s.li,{children:["Implements ",(0,r.jsx)(s.strong,{children:"circuit breaker"})," via ",(0,r.jsx)(s.strong,{children:"Resilience4j"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"5\ufe0f\u20e3-devops--infra",children:(0,r.jsx)(s.strong,{children:"5\ufe0f\u20e3 DevOps & Infra"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Docker"}),": Dockerfile for containerization."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Kubernetes"}),": Helm charts and manifests for deployment."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Observability"}),": Stack of Grafana, Prometheus, Loki."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Secrets & Config Management"}),": Vault and Spring Cloud Config."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Feature Flagging"}),": Using ",(0,r.jsx)(s.strong,{children:"Unleash"})," or ",(0,r.jsx)(s.strong,{children:"FF4J"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"6\ufe0f\u20e3-testing--quality",children:(0,r.jsx)(s.strong,{children:"6\ufe0f\u20e3 Testing & Quality"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Unit Tests:"})," JUnit, Testcontainers, Mockito."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Code Quality Checks:"})," SonarQube or Codacy."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Resilience Testing:"})," Chaos Monkey for Spring Boot."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:["This should be a solid implementation plan for the ",(0,r.jsx)(s.strong,{children:"Expenses Microservice"}),"! \ud83d\ude80\r\nDo you need API specifications in OpenAPI/Swagger format as well?"]}),"\n",(0,r.jsxs)(s.p,{children:["Here is the complete project request specification and design document for the ",(0,r.jsx)(s.strong,{children:"Expense Microservice"})," built using ",(0,r.jsx)(s.strong,{children:"Reactive Spring Boot (WebFlux)"}),". This includes architecture, endpoints, technologies, business logic, design patterns, and more."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-expense-microservice-specification-reactive-webflux",children:"\u2705 Expense Microservice Specification (Reactive, WebFlux)"}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-overview",children:"\ud83d\ude80 Overview"}),"\n",(0,r.jsx)(s.p,{children:"This microservice is responsible for managing expenses:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Records single-legged (normal expense) and double-legged (fund transfer) expenses."}),"\n",(0,r.jsxs)(s.li,{children:["Validates accounts by calling the ",(0,r.jsx)(s.strong,{children:"Accounts Microservice"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Publishes events to ",(0,r.jsx)(s.strong,{children:"Kafka"})," for downstream services like ",(0,r.jsx)(s.strong,{children:"Inventory Microservice"}),"."]}),"\n",(0,r.jsx)(s.li,{children:"Accepts optional product metadata (e.g., item purchased)."}),"\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsx)(s.strong,{children:"Redis"})," for caching."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Future Scope"}),": Cloud file storage for invoices/receipts."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-tech-stack",children:"\ud83d\udce6 Tech Stack"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Layer"}),(0,r.jsx)(s.th,{children:"Technology"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Language"}),(0,r.jsx)(s.td,{children:"Java (17+)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Framework"}),(0,r.jsx)(s.td,{children:"Spring Boot (Reactive), WebFlux"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Database"}),(0,r.jsx)(s.td,{children:"PostgreSQL"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Caching"}),(0,r.jsx)(s.td,{children:"Redis"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Messaging"}),(0,r.jsx)(s.td,{children:"Apache Kafka"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Observability"}),(0,r.jsx)(s.td,{children:"Spring Boot Actuator, Micrometer, Prometheus, Grafana"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Security"}),(0,r.jsx)(s.td,{children:"Spring Security, OAuth2/JWT"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Configuration"}),(0,r.jsx)(s.td,{children:"Spring Cloud Config, Consul, Vault"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Patterns"}),(0,r.jsx)(s.td,{children:"Choreography Saga, Circuit Breaker"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Testing"}),(0,r.jsx)(s.td,{children:"JUnit 5, Testcontainers, Mockito"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Feature Flagging"}),(0,r.jsx)(s.td,{children:"FF4J or Unleash"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Code Quality"}),(0,r.jsx)(s.td,{children:"SonarQube"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-endpoints--api-design-reactive-rest",children:"\ud83d\udd17 Endpoints & API Design (Reactive REST)"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Method"}),(0,r.jsx)(s.th,{children:"Endpoint"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"POST"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses"})}),(0,r.jsx)(s.td,{children:"Create new expense (single or double leg)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"GET"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/{expenseId}"})}),(0,r.jsx)(s.td,{children:"Get specific expense by ID"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"GET"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/user/{userId}"})}),(0,r.jsx)(s.td,{children:"Get all expenses for a user"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"GET"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/account/{accountId}"})}),(0,r.jsx)(s.td,{children:"Get expenses for a given account"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"GET"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/tags"})}),(0,r.jsx)(s.td,{children:"Get all supported tags (calls Metadata API)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"DELETE"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"/expenses/{expenseId}"})}),(0,r.jsx)(s.td,{children:"Delete expense (soft delete)"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["All APIs follow reactive ",(0,r.jsx)(s.code,{children:"Mono"})," or ",(0,r.jsx)(s.code,{children:"Flux"})," return types."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-event-topics-kafka",children:"\ud83d\udcdc Event Topics (Kafka)"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"EXPENSE_CREATED"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"EXPENSE_UPDATED"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"EXPENSE_DELETED"})}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-business-logic-summary",children:"\ud83e\udde0 Business Logic Summary"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"When an expense is created:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Validate ",(0,r.jsx)(s.code,{children:"sourceAccount"})," is ACTIVE via Accounts MS."]}),"\n",(0,r.jsxs)(s.li,{children:["If ",(0,r.jsx)(s.code,{children:"targetAccount"})," exists (double-legged), validate it too."]}),"\n",(0,r.jsx)(s.li,{children:"Optionally attach product metadata and publish to Kafka."}),"\n",(0,r.jsx)(s.li,{children:"Store expense in PostgreSQL."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Metadata API called to enrich tags for the expense with circuit breaker logic."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"\ufe0f-database-schema-postgresql",children:"\ud83d\uddc3\ufe0f Database Schema (PostgreSQL)"}),"\n",(0,r.jsxs)(s.h4,{id:"table-expenses",children:["Table: ",(0,r.jsx)(s.code,{children:"expenses"})]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Column"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"expense_id"})}),(0,r.jsx)(s.td,{children:"UUID (PK)"}),(0,r.jsx)(s.td,{children:"Unique ID"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"user_id"})}),(0,r.jsx)(s.td,{children:"UUID"}),(0,r.jsx)(s.td,{children:"User who created the expense"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"source_account_id"})}),(0,r.jsx)(s.td,{children:"UUID"}),(0,r.jsx)(s.td,{children:"Account from which amount is debited"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"target_account_id"})}),(0,r.jsx)(s.td,{children:"UUID?"}),(0,r.jsx)(s.td,{children:"Optional (for transfers)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"amount"})}),(0,r.jsx)(s.td,{children:"DECIMAL"}),(0,r.jsx)(s.td,{children:"Expense amount"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"currency"})}),(0,r.jsx)(s.td,{children:"VARCHAR(10)"}),(0,r.jsx)(s.td,{children:"ISO 4217"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"description"})}),(0,r.jsx)(s.td,{children:"TEXT"}),(0,r.jsx)(s.td,{children:"Optional description"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"tags"})}),(0,r.jsx)(s.td,{children:"TEXT[]"}),(0,r.jsx)(s.td,{children:"Array of tags"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"product_info"})}),(0,r.jsx)(s.td,{children:"JSONB?"}),(0,r.jsx)(s.td,{children:"Optional product metadata"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"created_at"})}),(0,r.jsx)(s.td,{children:"TIMESTAMP"}),(0,r.jsx)(s.td,{children:"Creation timestamp"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"updated_at"})}),(0,r.jsx)(s.td,{children:"TIMESTAMP"}),(0,r.jsx)(s.td,{children:"Last update timestamp"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"status"})}),(0,r.jsx)(s.td,{children:"ENUM"}),(0,r.jsx)(s.td,{children:"CREATED / DELETED"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-microservice-design-patterns-used",children:"\ud83e\udde9 Microservice Design Patterns Used"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Choreography Saga Pattern"}),": Expense MS publishes events to Kafka; Inventory MS consumes them."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Circuit Breaker"}),": For Metadata API using Resilience4j."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Service Discovery"}),": Consul."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"External Configuration"}),": Spring Cloud Config."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Centralized Secrets"}),": HashiCorp Vault."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-oopdesign-patterns-used",children:"\ud83e\uddf1 OOP/Design Patterns Used"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Builder Pattern"})," for immutable data object creation."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Factory Pattern"})," for ExpenseType resolution."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Strategy Pattern"})," for handling product processing (e.g., Inventory addition)."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Reactive Repository Pattern"})," using ",(0,r.jsx)(s.code,{children:"R2dbcRepository"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Decorator Pattern"})," for enrichment of tags from external APIs."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Observer Pattern"})," through Kafka event publishing."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-testing--quality",children:"\ud83e\uddea Testing & Quality"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Unit Testing"}),": JUnit 5, Mockito"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Integration"}),": Testcontainers for PostgreSQL/Kafka"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Code Quality"}),": SonarQube"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Test Coverage Reports"}),": JaCoCo"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-security",children:"\ud83d\udd10 Security"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"JWT Authentication"}),"\n",(0,r.jsx)(s.li,{children:"OAuth2 (for service-to-service communication)"}),"\n",(0,r.jsx)(s.li,{children:"HTTPS"}),"\n",(0,r.jsx)(s.li,{children:"Spring Security Filters with role-based access"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-observability--monitoring",children:"\ud83d\udd0d Observability & Monitoring"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tool"}),(0,r.jsx)(s.th,{children:"Purpose"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Micrometer"})}),(0,r.jsx)(s.td,{children:"Metrics instrumentation"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Prometheus"})}),(0,r.jsx)(s.td,{children:"Scraping metrics"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Grafana"})}),(0,r.jsx)(s.td,{children:"Visualizing metrics"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Spring Boot Actuator"})}),(0,r.jsx)(s.td,{children:"Health & metrics APIs"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"OpenTelemetry/Jaeger"})}),(0,r.jsx)(s.td,{children:"Distributed Tracing"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-devops--infra",children:"\ud83d\udea2 DevOps & Infra"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Tool"}),(0,r.jsx)(s.th,{children:"Purpose"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Docker"}),(0,r.jsx)(s.td,{children:"Containerization"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Kubernetes"}),(0,r.jsx)(s.td,{children:"Orchestration"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Helm"}),(0,r.jsx)(s.td,{children:"K8s templating (optional)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Spring Cloud Config"}),(0,r.jsx)(s.td,{children:"Externalized configs"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Vault"}),(0,r.jsx)(s.td,{children:"Secrets management"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Consul"}),(0,r.jsx)(s.td,{children:"Service Discovery"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"GitHub Actions"}),(0,r.jsx)(s.td,{children:"CI/CD"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-redis-usage",children:"\ud83e\uddf1 Redis Usage"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Cache expense summary per user"}),"\n",(0,r.jsx)(s.li,{children:"Cache tags retrieved from metadata API"}),"\n",(0,r.jsx)(s.li,{children:"Expiry: 5\u201310 mins"}),"\n",(0,r.jsx)(s.li,{children:"Use Reactive RedisTemplate"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"-future-features",children:"\ud83e\uddfe Future Features"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Cloud File Storage"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Upload receipts/invoices to S3/GCP/Blob Storage"}),"\n",(0,r.jsxs)(s.li,{children:["Store file metadata in ",(0,r.jsx)(s.code,{children:"expense_attachments"})," table"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"gRPC for metadata lookup"})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"GraphQL for unified user dashboard across all expenses/accounts/inventory"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.p,{children:"Would you like me to scaffold this microservice with full code and Docker/K8s support?"})]})}function x(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>d,x:()=>c});var i=n(6540);const r={},t=i.createContext(r);function d(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);